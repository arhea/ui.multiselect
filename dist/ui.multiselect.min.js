(function(e){function t(){var t=e(document.createElement("div"));t.addClass("ui-multiselect ui-widget ui-helper-reset");var n=e(document.createElement("div"));n.addClass("ui-widget-header ui-helper-reset ui-state-default");var r=e(document.createElement("div"));r.addClass("ui-multiselect-body ui-widget-content ui-helper-reset ui-state-default");var i=e(document.createElement("ul"));i.addClass("ui-helper-reset ui-state-default");var s=i.clone().addClass("ui-multiselect-choices");return i.addClass("ui-multiselect-selected"),r.append('<div class="ui-multiselect-selected-header ui-widget-header ui-helper-reset">Selected</div>'),r.append('<div class="ui-multiselect-choices-header ui-widget-header ui-helper-reset">Available</div>'),r.append(i,s),t.append(n,r),{container:t,header:n,selectedHeader:r.find(".ui-multiselect-selected-header"),choicesHeader:r.find(".ui-multiselect-choices-header"),selectedList:i,choicesList:s,content:r}}function n(t,n){var r=n?"ui-icon-minus":"ui-icon-plus",i=e(document.createElement("li"));return i.addClass("ui-state-default ui-multiselect-item"),i.data("value",t.value),i.html('<span class="ui-icon '+r+'"></span>'+t.innerHTML),i}e.widget("ui.multiselect",{options:{sort:function(t,n){return e(t).text().toLowerCase().localeCompare(e(n).text().toLowerCase())}},elements:{},_create:function(){e.extend(this.elements,t()),this.elements.header.text("0 selected of 95"),this.elements.container.insertAfter(this.element),this.element.addClass("ui-helper-hidden"),this._on(this.elements.container,{"mouseover .ui-multiselect-item":this._onItemMouseover,"mouseout .ui-multiselect-item":this._onItemMouseout,"mousedown .ui-multiselect-item":this._onItemMousedown,"touchstart .ui-multiselect-item":this._onItemMousedown,"mouseup .ui-multiselect-item":this._onItemMouseup,"touchend .ui-multiselect-item":this._onItemMouseup}),this._updateLists()},_onItemMouseover:function(t){e(t.currentTarget).addClass("ui-state-hover")},_onItemMouseout:function(t){e(t.currentTarget).removeClass("ui-state-hover ui-state-active")},_onItemMousedown:function(t){e(t.currentTarget).removeClass("ui-state-hover").addClass("ui-state-active")},_onItemMouseup:function(t){t.preventDefault();var n=e(t.currentTarget);n.removeClass("ui-state-hover ui-state-active"),n.find(".ui-icon").toggleClass("ui-icon-plus ui-icon-minus"),n.parent().hasClass("ui-multiselect-selected")?this.elements.choicesList.append(n):this.elements.selectedList.append(n),this._updateCount(),this._setValues(),this.sort()},_setValues:function(){var t=this.element.find("option").removeAttr("selected");this.elements.selectedList.find(".ui-multiselect-item").each(function(){var n=e(this);t.filter("[value="+n.data("value")+"]").attr("selected","selected")}),this.element.trigger("change")},_updateCount:function(){var e=this.elements.selectedList.find(".ui-multiselect-item").length,t=this.elements.choicesList.find(".ui-multiselect-item").length;this.elements.header.text(e+" selected of "+(e+t))},_updateLists:function(){var e=this.element.find("option"),t=this.elements.selectedList,r=this.elements.choicesList;e.each(function(){var e=n(this,this.selected);this.selected?t.append(e):r.append(e)}),this._updateCount(),this.sort()},_destroy:function(){this.element.removeClass("ui-helper-hidden"),this._off(this.elements.container),this.container.remove()},_setOption:function(e,t){this._superApply("_setOption",e,t),this.refresh()},_setOptions:function(e){this._superApply("_setOptions",e),this.refresh()},refresh:function(){this._setValues(),this._updateLists(),this._trigger("refresh",this.elements)},sort:function(){var e=this.elements.selectedList.find(".ui-multiselect-item").detach();e.sort(this.options.sort),this.elements.selectedList.append(e);var t=this.elements.choicesList.find(".ui-multiselect-item").detach();t.sort(this.options.sort),this.elements.choicesList.append(t),this._trigger("sort",this.elements)}})})(jQuery);